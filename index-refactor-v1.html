<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Prompt Forge - Modern Interface</title>
    <link rel="stylesheet" href="styles-refactor-v1.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=SF+Pro+Display:wght@300;400;500;600;700&family=SF+Pro+Text:wght@300;400;500;600&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css" integrity="sha512-SnH5WK+bZxgPHs44uWIX+LLJAJ9/2PkPKZ5QiAj6Ta86w+fsb2TkcmfRyVX3pBnMFcV7oQPJkl9QevSCWr3W6A==" crossorigin="anonymous" referrerpolicy="no-referrer" />
</head>
<body>
    <!-- Theme & Style Toolbar -->
    <div class="theme-toolbar">
        <div class="toolbar-section">
            <div class="toolbar-label">Theme</div>
            <div class="theme-randomizer">
                <button id="randomizeThemeButton" class="randomize-btn" title="Randomize Theme & Style">
                    <i class="fas fa-shuffle"></i>
                    <span>Random Look</span>
                </button>
                <button id="lockThemeButton" class="lock-btn" title="Lock Current Theme">
                    <i class="fas fa-lock-open"></i>
                </button>
            </div>
        </div>
        
        <div class="toolbar-section">
            <div class="toolbar-label">Manual</div>
            <div class="manual-controls">
                <div class="theme-selector">
                    <button class="theme-btn active" data-theme="default" title="Ocean Blue">
                        <div class="theme-preview theme-default"></div>
                    </button>
                    <button class="theme-btn" data-theme="purple" title="Cosmic Purple">
                        <div class="theme-preview theme-purple"></div>
                    </button>
                    <button class="theme-btn" data-theme="green" title="Forest Green">
                        <div class="theme-preview theme-green"></div>
                    </button>
                    <button class="theme-btn" data-theme="orange" title="Sunset Orange">
                        <div class="theme-preview theme-orange"></div>
                    </button>
                    <button class="theme-btn" data-theme="red" title="Crimson Red">
                        <div class="theme-preview theme-red"></div>
                    </button>
                </div>
                <div class="style-selector">
                    <button class="style-btn active" data-style="curved" title="Curved Elements">
                        <div class="style-preview style-curved"></div>
                    </button>
                    <button class="style-btn" data-style="square" title="Square Elements">
                        <div class="style-preview style-square"></div>
                    </button>
                    <button class="style-btn" data-style="minimal" title="Minimal Elements">
                        <div class="style-preview style-minimal"></div>
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Vertical Section Navigator -->
    <div class="section-navigator">
        <div class="nav-dots">
            <button class="nav-dot active" data-section="0" title="Home"></button>
            <button class="nav-dot" data-section="1" title="Keywords"></button>
            <button class="nav-dot" data-section="2" title="Prompts"></button>
            <button class="nav-dot" data-section="3" title="Configuration"></button>
        </div>
    </div>

    <div class="app-container" id="container">
        <!-- Section 0: Hero & Quick Actions -->
        <section class="app-section active" id="section-0">
            <header class="hero-section">
                <div class="hero-content">
                    <h1 class="hero-title">
                        <span class="title-main">Prompt Forge</span>
                        <span class="title-sub">Artistic T-Shirt Generator</span>
                    </h1>
                    <p class="hero-description">Create stunning prompts with intelligent keyword generation and AI refinement</p>
                </div>
            </header>

            <!-- Quick Actions -->
            <section class="quick-actions-section">
                <div class="quick-actions-grid">
                    <div class="quick-action-card" id="feelLuckyCard">
                        <div class="card-icon">
                            <i class="fas fa-dice"></i>
                        </div>
                        <h3>Feeling Lucky</h3>
                        <p>Generate random keywords instantly</p>
                        <div class="quantity-selector">
                            <div class="quantity-option">
                                <input type="radio" id="lucky-qty-small-v1" name="luckyQuantity" value="10-20" checked>
                                <label for="lucky-qty-small-v1">10-20</label>
                            </div>
                            <div class="quantity-option">
                                <input type="radio" id="lucky-qty-medium-v1" name="luckyQuantity" value="30-50">
                                <label for="lucky-qty-medium-v1">30-50</label>
                            </div>
                            <div class="quantity-option">
                                <input type="radio" id="lucky-qty-large-v1" name="luckyQuantity" value="60-100">
                                <label for="lucky-qty-large-v1">60-100</label>
                            </div>
                        </div>
                        <button id="feelLuckyButton" class="primary-button">
                            <span>Generate Keywords</span>
                            <i class="fas fa-arrow-right"></i>
                        </button>
                    </div>

                    <div class="quick-action-card" id="selectKeywordsCard">
                        <div class="card-icon">
                            <i class="fas fa-hand-pointer"></i>
                        </div>
                        <h3>Select Keywords</h3>
                        <p>Choose keywords with smart slider interface</p>
                        <button id="openKeywordSliderButton" class="primary-button">
                            <span>Open Selector</span>
                            <i class="fas fa-arrow-right"></i>
                        </button>
                    </div>
                </div>
            </section>
        </section>

        <!-- Section 1: Keyword Selection -->
        <section class="app-section" id="section-1">
            <div class="section-header">
                <h2>Keyword Categories</h2>
                <p>Select keywords to build your prompt</p>
                <button id="submitKeywordsButton" class="primary-button large">
                    <i class="fas fa-check"></i>
                    <span>Use Selected Keywords</span>
                </button>
            </div>
            
            <div class="keyword-slider-container">
                <div class="keyword-slider" id="keywordSlider">
                    <!-- Keyword categories will be populated here -->
                </div>
                <div class="slider-controls">
                    <button class="slider-nav prev" id="sliderPrev">
                        <i class="fas fa-chevron-left"></i>
                    </button>
                    <button class="slider-nav next" id="sliderNext">
                        <i class="fas fa-chevron-right"></i>
                    </button>
                </div>
            </div>
        </section>

        <!-- Section 2: Prompt Generation -->
        <section class="app-section" id="section-2">
            <div class="section-header">
                <h2>Prompt Generation</h2>
                <p>Review and enhance your generated prompts</p>
            </div>

            <div id="mainMessageBox" class="message-box" style="display: none;"></div>
            
            <div class="output-card" id="keywords-summary-container">
                <div class="output-header">
                    <h3>Selected Keywords</h3>
                    <div class="output-actions">
                        <button type="button" class="copy-button" data-target="generatedKeywords" title="Copy Keywords">
                            <i class="fas fa-copy"></i>
                        </button>
                        <button type="button" id="generatePromptButton" class="primary-button" title="Generate AI Prompt from Keywords">
                            <i class="fas fa-wand-magic-sparkles"></i>
                            <span>Generate Prompt</span>
                        </button>
                    </div>
                </div>
                <div class="output-content">
                    <textarea id="generatedKeywords" class="output-textarea" placeholder="Use 'Feeling Lucky' or 'Select Keywords' to populate this list..."></textarea>
                </div>
            </div>

            <div class="output-card" id="api-prompt-output-container" style="display: none;">
                <div class="output-header">
                    <h3>AI Enhanced Prompt</h3>
                    <button type="button" class="copy-button" data-target="apiGeneratedPrompt" title="Copy AI Generated Prompt">
                        <i class="fas fa-copy"></i>
                    </button>
                </div>
                <div class="output-content">
                    <textarea id="apiGeneratedPrompt" class="output-textarea" readonly placeholder="AI enhanced prompt will appear here..."></textarea>
                </div>
            </div>
        </section>

        <!-- Section 3: Configuration -->
        <section class="app-section" id="section-3">
            <div class="section-header">
                <h2>Configuration</h2>
                <p>Configure LLM and image generation settings</p>
            </div>
            <!-- LLM Configuration -->
            <div class="config-card collapsible">
                <button type="button" class="config-header" aria-expanded="true" aria-controls="llm-config-content">
                    <div class="config-title">
                        <i class="fas fa-brain"></i>
                        <h3>LLM Configuration</h3>
                    </div>
                    <i class="fas fa-chevron-down collapse-icon"></i>
                </button>
                <div id="llm-config-content" class="config-content">
                    <div class="form-grid">
                        <div class="form-group">
                            <label for="llmEndpoint">LLM Endpoint</label>
                            <select id="llmEndpoint" class="form-select">
                                <option value="https://generativelanguage.googleapis.com/v1beta">Gemini API</option>
                                <option value="http://localhost:1234/v1">LM Studio (localhost:1234)</option>
                                <option value="http://localhost:11434/api/generate">Ollama (localhost:11434)</option>
                                <option value="custom_llm">Custom LLM Endpoint</option>
                            </select>
                        </div>
                        
                        <div id="customLlmEndpointContainer" class="form-group" style="display: none;">
                            <label for="customLlmEndpoint">Custom Endpoint URL</label>
                            <input type="text" id="customLlmEndpoint" class="form-input" placeholder="Enter custom LLM endpoint URL">
                        </div>
                        
                        <div class="form-group">
                            <label for="llmApiKey">API Key</label>
                            <input type="password" id="llmApiKey" class="form-input" placeholder="Enter API Key (if required)">
                        </div>
                        
                        <div class="form-group">
                            <label for="llmModelName">Model Name</label>
                            <input type="text" id="llmModelName" class="form-input" placeholder="e.g., llama3, gemini-pro">
                        </div>
                    </div>

                    <div class="form-group">
                        <label for="systemPrompt">System Prompt</label>
                        <textarea id="systemPrompt" class="form-textarea" placeholder="System instructions for the AI..."></textarea>
                    </div>

                    <div class="form-group">
                        <label>Output Format</label>
                        <div class="radio-group">
                            <div class="radio-option">
                                <input type="radio" id="format-auto-v1" name="promptFormat" value="auto">
                                <label for="format-auto-v1">Auto (Generic)</label>
                            </div>
                            <div class="radio-option">
                                <input type="radio" id="format-keywords-v1" name="promptFormat" value="keywords">
                                <label for="format-keywords-v1">Keywords/Concise</label>
                            </div>
                            <div class="radio-option">
                                <input type="radio" id="format-structured-v1" name="promptFormat" value="structured" checked>
                                <label for="format-structured-v1">Structured/Detailed</label>
                            </div>
                            <div class="radio-option">
                                <input type="radio" id="format-sentences-v1" name="promptFormat" value="sentences">
                                <label for="format-sentences-v1">Sentences/Paragraph</label>
                            </div>
                        </div>
                    </div>

                    <div id="configMessageBox" class="message-box" style="display: none;"></div>
                </div>
            </div>

            <!-- Image Generation Configuration -->
            <div class="config-card collapsible">
                <button type="button" class="config-header" aria-expanded="true" aria-controls="image-gen-config-content">
                    <div class="config-title">
                        <i class="fas fa-image"></i>
                        <h3>Image Generation</h3>
                    </div>
                    <i class="fas fa-chevron-down collapse-icon"></i>
                </button>
                <div id="image-gen-config-content" class="config-content">
                    <p class="config-description">Configure ComfyUI or add custom endpoints for image generation.</p>
                    
                    <div id="image-endpoints">
                        <div class="endpoint-option">
                            <div class="endpoint-header">
                                <input type="checkbox" id="img-comfyui" value="local_comfyui" data-endpoint="http://127.0.0.1:8188" checked>
                                <label for="img-comfyui">Local ComfyUI</label>
                                <span class="endpoint-status">Requires server</span>
                            </div>
                            
                            <div class="endpoint-config">
                                <div class="form-group">
                                    <label for="comfyWorkflowSelect">Workflow</label>
                                    <select id="comfyWorkflowSelect" class="form-select">
                                        <option value="">-- Select Workflow --</option>
                                    </select>
                                </div>

                                <div id="comfySpecificParamsContainer" style="display: none;">
                                    <div id="ggufModelSelectorContainer" class="form-group" style="display: none;">
                                        <label for="ggufModelSelect">U-Net Model</label>
                                        <select id="ggufModelSelect" class="form-select"></select>
                                    </div>
                                    
                                    <div id="checkpointModelSelectorContainer" class="form-group" style="display: none;">
                                        <label for="checkpointModelSelect">Checkpoint</label>
                                        <select id="checkpointModelSelect" class="form-select"></select>
                                    </div>
                                    
                                    <div id="comfyImageParamsContainer" class="form-grid">
                                        <div class="form-group">
                                            <label for="comfyImageWidth">Width</label>
                                            <input type="number" id="comfyImageWidth" class="form-input" value="512" step="64">
                                        </div>
                                        <div class="form-group">
                                            <label for="comfyImageHeight">Height</label>
                                            <input type="number" id="comfyImageHeight" class="form-input" value="768" step="64">
                                        </div>
                                        <div class="form-group">
                                            <label for="comfySteps">Steps</label>
                                            <input type="number" id="comfySteps" class="form-input" value="4" min="1" max="100">
                                        </div>
                                        <div class="form-group full-width">
                                            <label for="comfyNegativePrompt">Negative Prompt</label>
                                            <input type="text" id="comfyNegativePrompt" class="form-input" placeholder="e.g., text, watermark">
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <div id="custom-endpoints-list"></div>
                        
                        <button type="button" id="add-custom-endpoint-btn" class="secondary-button">
                            <i class="fas fa-plus"></i>
                            <span>Add Custom Endpoint</span>
                        </button>
                    </div>

                    <div class="form-group">
                        <label>Prompt to Send</label>
                        <div class="radio-group">
                            <div class="radio-option">
                                <input type="radio" id="send-keywords-v1" name="promptToSend" value="keywords">
                                <label for="send-keywords-v1">Keywords Summary</label>
                            </div>
                            <div class="radio-option">
                                <input type="radio" id="send-api-prompt-v1" name="promptToSend" value="api" checked>
                                <label for="send-api-prompt-v1">AI Generated Prompt</label>
                            </div>
                        </div>
                    </div>

                    <div class="form-group">
                        <div class="checkbox-option">
                            <input type="checkbox" id="enableSuccessivePrompt">
                            <label for="enableSuccessivePrompt">Attempt second round (Experimental)</label>
                        </div>
                    </div>

                    <!-- Continuous Generation -->
                    <div class="continuous-gen-section">
                        <div class="section-header">
                            <h4>Continuous Generation</h4>
                            <div class="toggle-switch">
                                <input type="checkbox" id="enableContinuousGen">
                                <label for="enableContinuousGen" class="toggle-label">
                                    <span class="toggle-slider"></span>
                                </label>
                            </div>
                        </div>
                        
                        <div id="continuous-options" class="continuous-options" style="display: none;">
                            <div class="form-group">
                                <label for="continuousGenCount">Number of Images</label>
                                <input type="number" id="continuousGenCount" class="form-input" value="5" min="1" max="100">
                            </div>
                            
                            <div class="form-group">
                                <label>Generation Mode</label>
                                <div class="radio-group">
                                    <div class="radio-option">
                                        <input type="radio" name="continuousGenMode" value="keep_keywords_new_api" id="mode-keep-keywords-v1" checked>
                                        <label for="mode-keep-keywords-v1">Keep Keywords, New AI Prompt</label>
                                    </div>
                                    <div class="radio-option">
                                        <input type="radio" name="continuousGenMode" value="new_lucky_api" id="mode-new-lucky-v1">
                                        <label for="mode-new-lucky-v1">New 'Feeling Lucky', New AI Prompt</label>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="action-buttons">
                        <button type="button" id="sendPromptButton" class="primary-button">
                            <i class="fas fa-paper-plane"></i>
                            <span>Send Prompt / Start Batch</span>
                        </button>
                        <button type="button" id="stopBatchButton" class="danger-button hidden">
                            <i class="fas fa-stop-circle"></i>
                            <span>Stop Batch</span>
                        </button>
                    </div>
                </div>
            </div>

            <!-- Guidelines Reference -->
            <div class="config-card collapsible">
                <button type="button" class="config-header" aria-expanded="false" aria-controls="guidelines-content">
                    <div class="config-title">
                        <i class="fas fa-book"></i>
                        <h3>Prompt Guidelines</h3>
                    </div>
                    <i class="fas fa-chevron-down collapse-icon"></i>
                </button>
                <div id="guidelines-content" class="config-content" hidden>
                    <div class="guidelines-table-container">
                        <table class="guidelines-table">
                            <thead>
                                <tr>
                                    <th>Feature</th>
                                    <th>Stable Diffusion 1.5 / 2.x</th>
                                    <th>Stable Diffusion XL / Flux</th>
                                    <th>DALL-E 3</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td><strong>Prompt Style</strong></td>
                                    <td>Keywords, comma-separated</td>
                                    <td>Natural language or keywords</td>
                                    <td>Natural language descriptions</td>
                                </tr>
                                <tr>
                                    <td><strong>Length</strong></td>
                                    <td>Short to medium (75-150 tokens)</td>
                                    <td>Medium to long (100-300 tokens)</td>
                                    <td>Detailed descriptions (up to 4000 chars)</td>
                                </tr>
                                <tr>
                                    <td><strong>Negative Prompts</strong></td>
                                    <td>Highly effective</td>
                                    <td>Moderately effective</td>
                                    <td>Not supported</td>
                                </tr>
                                <tr>
                                    <td><strong>Style Keywords</strong></td>
                                    <td>Essential (e.g., "digital art", "photorealistic")</td>
                                    <td>Helpful but less critical</td>
                                    <td>Integrated into description</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </section>
        </section>
    </div>

    <!-- Background Video -->
    <div class="background-video-container">
        <video autoplay muted loop class="background-video">
            <source src="https://image.civitai.com/xG1nkqKTMzGDvpLrqFT7WA/2f36ecd5-e8bc-4459-860a-435ac643b127/transcode=true,width=450/68466816.webm" type="video/webm">
        </video>
    </div>

    <!-- Scripts -->
    <script src="data.js"></script>
    <script>
        // Debug data loading
        console.log('Data.js loaded, checking variables...');
        console.log('dropdownData:', typeof window.dropdownData, window.dropdownData ? 'exists' : 'missing');
        console.log('keywordCategories:', typeof window.keywordCategories, window.keywordCategories ? 'exists' : 'missing');
        if (window.dropdownData) {
            console.log('dropdownData keys:', Object.keys(window.dropdownData));
        }
        if (window.keywordCategories) {
            console.log('keywordCategories keys:', Object.keys(window.keywordCategories));
        }
    </script>
    <script src="utility_functions-refactor.js"></script>
    <script src="api_calls-refactor.js"></script>
    <script src="ui_updates-refactor-v1.js"></script>
    <script src="ui_setup-refactor-v1.js"></script>
    <script src="keyword_slider-refactor-v1.js"></script>
    <script src="state_management-refactor.js"></script>
    <script src="event_handlers-refactor-v1.js"></script>
    <script src="main_script-refactor-v1.js"></script>
</body>
</html>